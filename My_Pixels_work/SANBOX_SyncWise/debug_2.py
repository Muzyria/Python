import random


def point_in_polygon(point, polygon):
    """
    Проверяет, находится ли заданная точка внутри многоугольника.
    point: Координаты точки в формате 'lat, lng'.
    polygon: Список координат многоугольника.
    Возвращает True, если точка находится внутри многоугольника, и False в противном случае.
    """
    lat, lng = map(float, point.split(','))

    is_inside = False
    n = len(polygon)
    p1x, p1y = map(float, polygon[0].values())
    for i in range(n + 1):
        p2x, p2y = map(float, polygon[i % n].values())
        if (lng > min(p1y, p2y)):
            if (lng <= max(p1y, p2y)):
                if (lat <= max(p1x, p2x)):
                    if (p1y != p2y):
                        xinters = (lng - p1y) * (p2x - p1x) / (p2y - p1y) + p1x
                    if (p1x == p2x or lat <= xinters):
                        is_inside = not is_inside
        p1x, p1y = p2x, p2y

    return is_inside


def generate_random_point_in_polygon(polygon):
    """
    Генерирует случайную точку внутри заданного многоугольника.
    polygon: Список координат многоугольника.
    Возвращает координаты случайной точки в виде строки 'lat, lng'.
    """
    x_coords = [float(coord['lat']) for coord in polygon]
    y_coords = [float(coord['lng']) for coord in polygon]

    min_x, max_x = min(x_coords), max(x_coords)
    min_y, max_y = min(y_coords), max(y_coords)

    while True:
        random_x = random.uniform(min_x, max_x)
        random_y = random.uniform(min_y, max_y)

        if point_in_polygon(f'{random_x},{random_y}', polygon):
            return f'{random_x},{random_y}'


# Пример использования

polygon = [
    {'lat': '50.0844272', 'lng': '36.2357837'},
    {'lat': '50.0835598', 'lng': '36.2353009'},
    {'lat': '50.0832775', 'lng': '36.2373823'}
]

random_point = generate_random_point_in_polygon(polygon)
print("Случайная точка внутри многоугольника:", random_point)


def generate_random_point(min_lat, max_lat, min_lng, max_lng, polygons):
    """
    Генерирует случайную точку внутри заданной области, но вне многоугольников.
    min_lat: Минимальное значение широты.
    max_lat: Максимальное значение широты.
    min_lng: Минимальное значение долготы.
    max_lng: Максимальное значение долготы.
    polygons: Список многоугольников, каждый многоугольник представлен списком координат.
    Возвращает координаты случайной точки в виде строки 'lat, lng'.
    """
    while True:
        random_lat = random.uniform(min_lat, max_lat)
        random_lng = random.uniform(min_lng, max_lng)
        random_point = f'{random_lat},{random_lng}'

        is_inside_polygon = False
        for polygon in polygons:
            if point_in_polygon(random_point, polygon):
                is_inside_polygon = True
                break

        if not is_inside_polygon:
            return random_point


# Пример использования

polygons = [[{'lat': '50.0844272', 'lng': '36.2357837'}, {'lat': '50.0835598', 'lng': '36.2353009'},
             {'lat': '50.0832775', 'lng': '36.2373823'}],
            [{'lat': '50.0832586', 'lng': '36.2349334'}, {'lat': '50.0840641', 'lng': '36.2345632'},
             {'lat': '50.0840813', 'lng': '36.2341931'}, {'lat': '50.0840813', 'lng': '36.2341931'}],
            [{'lat': '50.0843162', 'lng': '36.2347980'}, {'lat': '50.0836966', 'lng': '36.2348838'},
             {'lat': '50.0839307', 'lng': '36.2352539'}],
            [{'lat': '50.0833868', 'lng': '36.2353344'}, {'lat': '50.0830357', 'lng': '36.2348945'},
             {'lat': '50.0829703', 'lng': '36.2359781'}],
            [{'lat': '50.0848712', 'lng': '36.2403273'}, {'lat': '50.0804101', 'lng': '36.2382674'},
             {'lat': '50.0788679', 'lng': '36.2479662'}],
            [{'lat': '50.0821953', 'lng': '36.2334797'}, {'lat': '50.0816445', 'lng': '36.2330720'},
             {'lat': '50.0815688', 'lng': '36.2340805'}],
            [{'lat': '50.0832530', 'lng': '36.2345351'}, {'lat': '50.0829398', 'lng': '36.2346585'},
             {'lat': '50.0831876', 'lng': '36.2347550'}],
            [{'lat': '50.0849038', 'lng': '36.2376738'}, {'lat': '50.0852343', 'lng': '36.2397766'},
             {'lat': '50.0841879', 'lng': '36.2414932'}, {'lat': '50.0837473', 'lng': '36.2393475'}],
            [{'lat': '50.0830251', 'lng': '36.2339904'}, {'lat': '50.0833625', 'lng': '36.2339475'},
             {'lat': '50.0833969', 'lng': '36.2341191'}, {'lat': '50.0807941', 'lng': '36.2358891'},
             {'lat': '50.0806840', 'lng': '36.2350738'}, {'lat': '50.0819509', 'lng': '36.2340119'},
             {'lat': '50.0819509', 'lng': '36.2340119'}],
            [{'lat': '50.0792973', 'lng': '36.2373513'}, {'lat': '50.0785531', 'lng': '36.2382310'},
             {'lat': '50.0790906', 'lng': '36.2395614'}, {'lat': '50.0798486', 'lng': '36.2386602'},
             {'lat': '50.0798486', 'lng': '36.2385958'}],
            [{'lat': '50.0802063', 'lng': '36.2396908'}, {'lat': '50.0794346', 'lng': '36.2405491'},
             {'lat': '50.0799032', 'lng': '36.2416220'}, {'lat': '50.0806749', 'lng': '36.2408066'},
             {'lat': '50.0806749', 'lng': '36.2408066'}],
            [{'lat': '50.0830160', 'lng': '36.2367189'}, {'lat': '50.0821072', 'lng': '36.2352598'},
             {'lat': '50.0810332', 'lng': '36.2374914'}, {'lat': '50.0810332', 'lng': '36.2374914'}],
            [{'lat': '50.0791811', 'lng': '36.2322845'}, {'lat': '50.0789263', 'lng': '36.2326385'},
             {'lat': '50.0794221', 'lng': '36.2338935'}, {'lat': '50.0799454', 'lng': '36.2363715'},
             {'lat': '50.0801176', 'lng': '36.2362642'}, {'lat': '50.0798284', 'lng': '36.2333143'},
             {'lat': '50.0798284', 'lng': '36.2333143'}],
            [{'lat': '50.0829714', 'lng': '36.2320627'}, {'lat': '50.0833708', 'lng': '36.2332215'},
             {'lat': '50.0828199', 'lng': '36.2335005'}, {'lat': '50.0824274', 'lng': '36.2322987'},
             {'lat': '50.0824274', 'lng': '36.2322987'}],
            [{'lat': '50.0886762', 'lng': '36.2224817'}, {'lat': '50.0912368', 'lng': '36.2263441'},
             {'lat': '50.0897500', 'lng': '36.2263870'}, {'lat': '50.0900254', 'lng': '36.2285757'},
             {'lat': '50.0889791', 'lng': '36.2281036'}, {'lat': '50.0885385', 'lng': '36.2287045'},
             {'lat': '50.0880980', 'lng': '36.2254858'}, {'lat': '50.0879603', 'lng': '36.2242413'},
             {'lat': '50.0892819', 'lng': '36.2251854'}, {'lat': '50.0884559', 'lng': '36.2229109'}],
            [{'lat': '50.0861980', 'lng': '36.2388754'}, {'lat': '50.0868864', 'lng': '36.2377596'},
             {'lat': '50.0843531', 'lng': '36.2353134'}, {'lat': '50.0844357', 'lng': '36.2387037'},
             {'lat': '50.0855096', 'lng': '36.2406349'}, {'lat': '50.0866111', 'lng': '36.2400770'}]]

min_lat = 50.08
max_lat = 50.09
min_lng = 36.23
max_lng = 36.24

random_point = generate_random_point(min_lat, max_lat, min_lng, max_lng, polygons)
print("Случайная точка внутри заданной области, но вне многоугольников:", random_point)
